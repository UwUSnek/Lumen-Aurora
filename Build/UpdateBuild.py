import BuildOptions
from ProjectPath import ProjectPath, EnginePath
from Platform import Platform as pf
from Type import Type as tp
import os.path
thisdir = os.path.dirname(os.path.abspath(__file__))




def getPf():
    return "Linux" if pf == "l" else "Windows"
def getTp():
    return "Debug" if tp == "d" else "Release"




f = open(thisdir + "/../" + ProjectPath + "/.vscode/tasks.json", "w")
f.write("""
//This file was generated by the engine
//Do not modify it. Changes could be overwritten without any advise
{
    "tasks": [
        {
            "type": "shell",
            "label": "Build LuxEngine  |  """ + getPf() + "  |  " + getTp() + """\",
            "command": "",
            "args": [
                "/usr/bin/g++",
                //Source files
		            "-xc++", \"""" + EnginePath + """/LuxEngine/LuxEngineBuild.cpp.build",
		            "Test.cpp",\n""" +\
                    (BuildOptions.getDebugOptions() if tp == "d" else BuildOptions.getReleaseOptions()) + """,
                //Engine
                    "-std=c++2a", "-mavx", "-pipe", "-pthread",
                    "-I./", "-ILuxEngine",
                    "-Wall",\n""" +\
                    BuildOptions.getEngineDeps() + """,
                //Output
					"-o", "./Build/""" + getPf() + '/LuxEngine' + getTp() + """\"
            ],
            "problemMatcher": [ "$gcc" ],
            "options": { "cwd": "${workspaceFolder}" },
            "group": { "kind": "build", "isDefault": true }
        },
        {
            "type": "shell",
            "label": " > Switch to """ + ("Windows" if pf == "l" else "Linux") + """\",
            "command": "python3",
            "args": [
                \"""" + EnginePath + """/Build/SetPlatform.py",
                \"""" + ("w" if pf == "l" else "l") + """\",
            ],
            "problemMatcher": [ ],
            "options": { "cwd": "${workspaceFolder}" },
            "group": { "kind": "build", "isDefault": true }
        },
        {
            "type": "shell",
            "label": " > Switch to """ + ("Release" if tp == "d" else "Debug") + """\",
            "command": "python3",
            "args": [
                \"""" + EnginePath + """/Build/SetType.py",
                \"""" + ("r" if tp == "d" else "d") + """\"
            ],
            "problemMatcher": [ ],
            "options": { "cwd": "${workspaceFolder}" },
            "group": { "kind": "build", "isDefault": true }
        }
    ]
}\n""")
f.close()


os.system("rm " + thisdir + "/__pycache__ -r")